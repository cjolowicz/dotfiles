#!/bin/bash

set -euo pipefail

function header() {
    echo
    rich "[b]$*[/b]" --rule
    echo
}

header "Homebrew"
brew update && brew upgrade

header "pipx"
pipx upgrade-all --include-injected

header "pip"
py -3.10 -m pip install --upgrade pip
py -3.10 -m pip install --user --upgrade importmagic epc

header "Spacemacs"
(

cd ~/.emacs.d

git fetch

if ! git diff --quiet develop origin/develop
then
    git plog -p --stat --reverse develop..origin/develop
    git pull
else
    echo "Already up-to-date."
fi

)

header "Poetry"
poetry self update
